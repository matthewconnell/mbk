{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 125,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [],
   "source": [
    "files = [\"adolescent-births-2016\", \n",
    "\"birth-rates-for-young-adult-women-2016\",\n",
    "\"child-housing-problems-2016\",\n",
    "\"child-living-arrangements-2016\",\n",
    "\"child-maltreatment-2016\",\n",
    "\"child-poverty-percent-2016\",\n",
    "\"exposure-to-violence-among-children-2016\",\n",
    "\"naep04-reading-2016\",\n",
    "\"young-adult-living-arrangements-2016\"]\n",
    "\n",
    "CSVs = []\n",
    "\n",
    "for file in files:\n",
    "    string_name = file + \".csv\"\n",
    "    csv = pd.read_csv(string_name, encoding = 'cp437')\n",
    "    csv = csv.replace('รป', '-', regex=True)  # Some CSVs have encoding issue where '-' is encoded as 'รป'\n",
    "    csv[\"Notes\"] = 0   # Add 'Notes' column if it does not exist\n",
    "    csv[\"Note\"] = 0 # Add 'Note' column if it does not exist\n",
    "    csv = csv.drop(columns = [\"Notes\", \"Note\"])  # Drop Notes column\n",
    "    #csv = csv.dropna()   # Drop rows with NAs\n",
    "    CSVs.append(csv)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "metadata": {},
   "outputs": [],
   "source": [
    "adolesent_births = CSVs[0].rename(columns={\"Percentage\":\"Rate (per 1,000 Females)\"}\n",
    "              ).drop(columns = [\"Characteristic\", \"Standard Error on Percentage\"]\n",
    "                    ).dropna()\n",
    "\n",
    "young_woman_births = CSVs[1].drop(columns=\"Characteristic\").dropna()\n",
    "young_woman_births = young_woman_births[['Race/ethnicity', 'Year', 'Rate (per 1,000 Females)', 'Age']]\n",
    "\n",
    "child_housing_problems = CSVs[2]\n",
    "\n",
    "child_living_arrangements = CSVs[3].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "child_maltreatment = CSVs[4].drop(columns = [\"Characteristic\", \"Race/ethnicity\"]).dropna()\n",
    "\n",
    "child_poverty_percent = CSVs[5].drop(columns=[\"Characteristic\", \"Note on Percent\"]).dropna()\n",
    "\n",
    "exposure_to_violent_crime = CSVs[6].drop(columns=[\"Characteristic\", \"Note on Percent\", \"Note on Count\"]).dropna()\n",
    "\n",
    "reading_scores = CSVs[7].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "young_adult_living_arrangements = CSVs[8].drop(columns=\"Characteristic\").dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Add column to be consistent with 'young_woman_births' df\n",
    "adolesent_births[\"Age\"] = \"Ages 15-17\"\n",
    "#adolesent_births"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Change \"Year type to int\n",
    "young_woman_births[\"Year\"] = young_woman_births[\"Year\"].astype(\"int64\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "metadata": {},
   "outputs": [],
   "source": [
    "test = \"Total - Hispanic, With severe housing problems\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 233,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['Total - Hispanic', ' With severe housing problems']"
      ]
     },
     "execution_count": 233,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test.split(sep = \",\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 234,
   "metadata": {},
   "outputs": [],
   "source": [
    "child_housing_problems[\"Characteristic\"] = child_housing_problems[\"Characteristic\"].str.replace(\"Total - \", \"\")\n",
    "#child_housing_problems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 235,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Split the character column by racial category and housing variable\n",
    "child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)\n",
    "\n",
    "# Set the housing variable as a column in the df\n",
    "child_housing_problems[\"housing_situation\"] = child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)[1]\n",
    "\n",
    "# Set the characteristic column to be consistent with the other dataframes\n",
    "child_housing_problems[\"characteristic\"] = child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)[0]\n",
    "\n",
    "# Drop the old Characteristic column\n",
    "child_housing_problems = child_housing_problems.drop(columns = [\"Characteristic\"])\n",
    "\n",
    "# child_housing_problems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 236,
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO\n",
    "# How to aggregate this data so it's useful \n",
    "# child_maltreatment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 237,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.set_option('display.max_rows', 100)\n",
    "child_poverty_percent['percent_living_in_poverty'] = child_poverty_percent['Percentage']\n",
    "child_poverty_percent = child_poverty_percent.drop(columns = \"Percentage\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 238,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Change column name\n",
    "exposure_to_violent_crime['percent_exposed_to_violent_crime'] = exposure_to_violent_crime['Percentage']\n",
    "exposure_to_violent_crime = exposure_to_violent_crime.drop(columns = 'Percentage')\n",
    "\n",
    "# Change column name\n",
    "exposure_to_violent_crime['count_exposed_to_violent_crime'] = exposure_to_violent_crime['Count']\n",
    "exposure_to_violent_crime = exposure_to_violent_crime.drop(columns = 'Count')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 239,
   "metadata": {},
   "outputs": [],
   "source": [
    "reading_scores['4th_grade_reading_scale_scores'] = reading_scores['Score']\n",
    "reading_scores = reading_scores.drop(columns = 'Score')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 240,
   "metadata": {},
   "outputs": [],
   "source": [
    "# No changes\n",
    "# young_adult_living_arrangements\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 241,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Race/ethnicity               object\n",
       "Year                          int64\n",
       "Rate (per 1,000 Females)    float64\n",
       "Age                          object\n",
       "dtype: object"
      ]
     },
     "execution_count": 241,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adolesent_births.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 242,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Race/ethnicity               object\n",
       "Year                          int64\n",
       "Rate (per 1,000 Females)    float64\n",
       "Age                          object\n",
       "dtype: object"
      ]
     },
     "execution_count": 242,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "young_woman_births.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 255,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Race/ethnicity</th>\n",
       "      <th>Year</th>\n",
       "      <th>Rate (per 1,000 Females)_x</th>\n",
       "      <th>Age_x</th>\n",
       "      <th>Rate (per 1,000 Females)_y</th>\n",
       "      <th>Age_y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2000</td>\n",
       "      <td>15.8</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>57.5</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2000</td>\n",
       "      <td>15.8</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>91.2</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2001</td>\n",
       "      <td>14.0</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>54.7</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2001</td>\n",
       "      <td>14.0</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>87.0</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2002</td>\n",
       "      <td>13.1</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>52.0</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2012</td>\n",
       "      <td>4.1</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>41.4</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>116</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2013</td>\n",
       "      <td>3.7</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>16.1</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2013</td>\n",
       "      <td>3.7</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>39.1</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>118</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2014</td>\n",
       "      <td>3.3</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>13.9</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>119</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2014</td>\n",
       "      <td>3.3</td>\n",
       "      <td>Ages 15-17</td>\n",
       "      <td>37.5</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>120 rows ร 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             Race/ethnicity  Year  Rate (per 1,000 Females)_x       Age_x  \\\n",
       "0       White, non-Hispanic  2000                        15.8  Ages 15-17   \n",
       "1       White, non-Hispanic  2000                        15.8  Ages 15-17   \n",
       "2       White, non-Hispanic  2001                        14.0  Ages 15-17   \n",
       "3       White, non-Hispanic  2001                        14.0  Ages 15-17   \n",
       "4       White, non-Hispanic  2002                        13.1  Ages 15-17   \n",
       "..                      ...   ...                         ...         ...   \n",
       "115  Asian/Pacific Islander  2012                         4.1  Ages 15-17   \n",
       "116  Asian/Pacific Islander  2013                         3.7  Ages 15-17   \n",
       "117  Asian/Pacific Islander  2013                         3.7  Ages 15-17   \n",
       "118  Asian/Pacific Islander  2014                         3.3  Ages 15-17   \n",
       "119  Asian/Pacific Islander  2014                         3.3  Ages 15-17   \n",
       "\n",
       "     Rate (per 1,000 Females)_y       Age_y  \n",
       "0                          57.5  Ages 18-19  \n",
       "1                          91.2  Ages 20-24  \n",
       "2                          54.7  Ages 18-19  \n",
       "3                          87.0  Ages 20-24  \n",
       "4                          52.0  Ages 18-19  \n",
       "..                          ...         ...  \n",
       "115                        41.4  Ages 20-24  \n",
       "116                        16.1  Ages 18-19  \n",
       "117                        39.1  Ages 20-24  \n",
       "118                        13.9  Ages 18-19  \n",
       "119                        37.5  Ages 20-24  \n",
       "\n",
       "[120 rows x 6 columns]"
      ]
     },
     "execution_count": 255,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adolesent_births.merge(young_woman_births, on = ['Race/ethnicity', 'Year'], how='inner')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 213,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Race/ethnicity</th>\n",
       "      <th>Year</th>\n",
       "      <th>Rate (per 1,000 Females)</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2000</td>\n",
       "      <td>57.5</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2001</td>\n",
       "      <td>54.7</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2002</td>\n",
       "      <td>52.0</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2003</td>\n",
       "      <td>52.0</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2004</td>\n",
       "      <td>48.6</td>\n",
       "      <td>Ages 18-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2010</td>\n",
       "      <td>42.6</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>176</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2011</td>\n",
       "      <td>41.9</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2012</td>\n",
       "      <td>41.4</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>178</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2013</td>\n",
       "      <td>39.1</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>179</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2014</td>\n",
       "      <td>37.5</td>\n",
       "      <td>Ages 20-24</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>150 rows ร 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             Race/ethnicity  Year  Rate (per 1,000 Females)         Age\n",
       "15      White, non-Hispanic  2000                      57.5  Ages 18-19\n",
       "16      White, non-Hispanic  2001                      54.7  Ages 18-19\n",
       "17      White, non-Hispanic  2002                      52.0  Ages 18-19\n",
       "18      White, non-Hispanic  2003                      52.0  Ages 18-19\n",
       "19      White, non-Hispanic  2004                      48.6  Ages 18-19\n",
       "..                      ...   ...                       ...         ...\n",
       "175  Asian/Pacific Islander  2010                      42.6  Ages 20-24\n",
       "176  Asian/Pacific Islander  2011                      41.9  Ages 20-24\n",
       "177  Asian/Pacific Islander  2012                      41.4  Ages 20-24\n",
       "178  Asian/Pacific Islander  2013                      39.1  Ages 20-24\n",
       "179  Asian/Pacific Islander  2014                      37.5  Ages 20-24\n",
       "\n",
       "[150 rows x 4 columns]"
      ]
     },
     "execution_count": 213,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "young_woman_births"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-191-3db8dfab2089>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  File \u001b[0;32m\"<ipython-input-191-3db8dfab2089>\"\u001b[0;36m, line \u001b[0;32m1\u001b[0m\n\u001b[0;31m    as.int([4.5, 3.2])\u001b[0m\n\u001b[0m     ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "as.int([4.5, 3.2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "adolesent_births['Age'].levels"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Race/ethnicity               object\n",
       "Age                          object\n",
       "Year                        float64\n",
       "Rate (per 1,000 Females)    float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 151,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "young_woman_births.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
