{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [],
   "source": [
    "files = [\"adolescent-births-2016\", \n",
    "\"birth-rates-for-young-adult-women-2016\",\n",
    "\"child-housing-problems-2016\",\n",
    "\"child-living-arrangements-2016\",\n",
    "\"child-maltreatment-2016\",\n",
    "\"child-poverty-percent-2016\",\n",
    "\"naep04-reading-2016\",\n",
    "\"young-adult-living-arrangements-2016\"]\n",
    "\n",
    "CSVs = []\n",
    "\n",
    "for file in files:\n",
    "    string_name = file + \".csv\"\n",
    "    csv = pd.read_csv(string_name, encoding = 'cp437')\n",
    "    csv = csv.replace('รป', '-', regex=True)  # Some CSVs have encoding issue where '-' is encoded as 'รป'\n",
    "    csv[\"Notes\"] = 0   # Add 'Notes' column if it does not exist\n",
    "    csv[\"Note\"] = 0 # Add 'Note' column if it does not exist\n",
    "    csv = csv.drop(columns = [\"Notes\", \"Note\"])  # Drop Notes column\n",
    "    #csv = csv.dropna()   # Drop rows with NAs\n",
    "    CSVs.append(csv)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Characteristic</th>\n",
       "      <th>Year</th>\n",
       "      <th>Percentage</th>\n",
       "      <th>Standard Error on Percentage</th>\n",
       "      <th>Count (in thousands)</th>\n",
       "      <th>Standard Error on Count (in thousands)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Total - All households</td>\n",
       "      <td>2003</td>\n",
       "      <td>100.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38434</td>\n",
       "      <td>254</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Total - All households</td>\n",
       "      <td>2007</td>\n",
       "      <td>100.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38098</td>\n",
       "      <td>305</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Total - All households</td>\n",
       "      <td>2011</td>\n",
       "      <td>100.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>37626</td>\n",
       "      <td>318</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Total - With severe housing problems</td>\n",
       "      <td>2003</td>\n",
       "      <td>12.9</td>\n",
       "      <td>0.003</td>\n",
       "      <td>4967</td>\n",
       "      <td>109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Total - With severe housing problems</td>\n",
       "      <td>2007</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.004</td>\n",
       "      <td>6480</td>\n",
       "      <td>146</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>Total - Two or More Races, With severe housing...</td>\n",
       "      <td>2007</td>\n",
       "      <td>18.5</td>\n",
       "      <td>0.037</td>\n",
       "      <td>72</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>Total - Two or More Races, With severe housing...</td>\n",
       "      <td>2011</td>\n",
       "      <td>21.3</td>\n",
       "      <td>0.035</td>\n",
       "      <td>84</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>Total - Two or More Races, Cost burden greater...</td>\n",
       "      <td>2003</td>\n",
       "      <td>14.9</td>\n",
       "      <td>0.029</td>\n",
       "      <td>56</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>Total - Two or More Races, Cost burden greater...</td>\n",
       "      <td>2007</td>\n",
       "      <td>18.2</td>\n",
       "      <td>0.036</td>\n",
       "      <td>71</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62</th>\n",
       "      <td>Total - Two or More Races, Cost burden greater...</td>\n",
       "      <td>2011</td>\n",
       "      <td>18.7</td>\n",
       "      <td>0.033</td>\n",
       "      <td>74</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>63 rows ร 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                       Characteristic  Year  Percentage  \\\n",
       "0                              Total - All households  2003       100.0   \n",
       "1                              Total - All households  2007       100.0   \n",
       "2                              Total - All households  2011       100.0   \n",
       "3                Total - With severe housing problems  2003        12.9   \n",
       "4                Total - With severe housing problems  2007        17.0   \n",
       "..                                                ...   ...         ...   \n",
       "58  Total - Two or More Races, With severe housing...  2007        18.5   \n",
       "59  Total - Two or More Races, With severe housing...  2011        21.3   \n",
       "60  Total - Two or More Races, Cost burden greater...  2003        14.9   \n",
       "61  Total - Two or More Races, Cost burden greater...  2007        18.2   \n",
       "62  Total - Two or More Races, Cost burden greater...  2011        18.7   \n",
       "\n",
       "    Standard Error on Percentage  Count (in thousands)  \\\n",
       "0                            NaN                 38434   \n",
       "1                            NaN                 38098   \n",
       "2                            NaN                 37626   \n",
       "3                          0.003                  4967   \n",
       "4                          0.004                  6480   \n",
       "..                           ...                   ...   \n",
       "58                         0.037                    72   \n",
       "59                         0.035                    84   \n",
       "60                         0.029                    56   \n",
       "61                         0.036                    71   \n",
       "62                         0.033                    74   \n",
       "\n",
       "    Standard Error on Count (in thousands)  \n",
       "0                                      254  \n",
       "1                                      305  \n",
       "2                                      318  \n",
       "3                                      109  \n",
       "4                                      146  \n",
       "..                                     ...  \n",
       "58                                      16  \n",
       "59                                      15  \n",
       "60                                      12  \n",
       "61                                      16  \n",
       "62                                      14  \n",
       "\n",
       "[63 rows x 6 columns]"
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adolesent_births = CSVs[0].rename(columns={\"Percentage\":\"Rate (per 1,000 Females)\"}\n",
    "              ).drop(columns = \"Characteristic\"\n",
    "                    ).dropna()\n",
    "\n",
    "young_woman_births = CSVs[1].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "CSVs[2]\n",
    "\n",
    "#child_maltreatment = CSVs[4].drop(columns = [\"Characteristic\", \"Race/ethnicity\"]).dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Race/ethnicity</th>\n",
       "      <th>Year</th>\n",
       "      <th>per_1000_f</th>\n",
       "      <th>SE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2000</td>\n",
       "      <td>15.8</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2001</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2002</td>\n",
       "      <td>13.1</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2003</td>\n",
       "      <td>12.4</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2004</td>\n",
       "      <td>12.0</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2010</td>\n",
       "      <td>5.1</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2011</td>\n",
       "      <td>4.6</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2012</td>\n",
       "      <td>4.1</td>\n",
       "      <td>0.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2013</td>\n",
       "      <td>3.7</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2014</td>\n",
       "      <td>3.3</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>75 rows ร 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Race/ethnicity  Year  per_1000_f    SE\n",
       "15     White, non-Hispanic  2000        15.8  0.06\n",
       "16     White, non-Hispanic  2001        14.0  0.06\n",
       "17     White, non-Hispanic  2002        13.1  0.06\n",
       "18     White, non-Hispanic  2003        12.4  0.06\n",
       "19     White, non-Hispanic  2004        12.0  0.06\n",
       "..                     ...   ...         ...   ...\n",
       "85  Asian/Pacific Islander  2010         5.1  0.13\n",
       "86  Asian/Pacific Islander  2011         4.6  0.12\n",
       "87  Asian/Pacific Islander  2012         4.1  0.11\n",
       "88  Asian/Pacific Islander  2013         3.7  0.10\n",
       "89  Asian/Pacific Islander  2014         3.3  0.10\n",
       "\n",
       "[75 rows x 4 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CSVs[0].rename(columns = {\"Percentage\":\"per_1000_f\",\n",
    "                                \"Standard Error on Percentage\": \"SE\"}).drop(columns = [\"Characteristic\", \"Notes\"]).dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
