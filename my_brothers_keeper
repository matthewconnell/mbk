{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 125,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {},
   "outputs": [],
   "source": [
    "files = [\"adolescent-births-2016\", \n",
    "\"birth-rates-for-young-adult-women-2016\",\n",
    "\"child-housing-problems-2016\",\n",
    "\"child-living-arrangements-2016\",\n",
    "\"child-maltreatment-2016\",\n",
    "\"child-poverty-percent-2016\",\n",
    "\"exposure-to-violence-among-children-2016\",\n",
    "\"naep04-reading-2016\",\n",
    "\"young-adult-living-arrangements-2016\"]\n",
    "\n",
    "CSVs = []\n",
    "\n",
    "for file in files:\n",
    "    string_name = file + \".csv\"\n",
    "    csv = pd.read_csv(string_name, encoding = 'cp437')\n",
    "    csv = csv.replace('รป', '-', regex=True)  # Some CSVs have encoding issue where '-' is encoded as 'รป'\n",
    "    csv[\"Notes\"] = 0   # Add 'Notes' column if it does not exist\n",
    "    csv[\"Note\"] = 0 # Add 'Note' column if it does not exist\n",
    "    csv = csv.drop(columns = [\"Notes\", \"Note\"])  # Drop Notes column\n",
    "    #csv = csv.dropna()   # Drop rows with NAs\n",
    "    CSVs.append(csv)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "metadata": {},
   "outputs": [],
   "source": [
    "adolesent_births = CSVs[0].rename(columns={\"Percentage\":\"Rate (per 1,000 Females)\"}\n",
    "              ).drop(columns = \"Characteristic\"\n",
    "                    ).dropna()\n",
    "\n",
    "young_woman_births = CSVs[1].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "child_housing_problems = CSVs[2]\n",
    "\n",
    "child_living_arrangements = CSVs[3].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "child_maltreatment = CSVs[4].drop(columns = [\"Characteristic\", \"Race/ethnicity\"]).dropna()\n",
    "\n",
    "child_poverty_percent = CSVs[5].drop(columns=[\"Characteristic\", \"Note on Percent\"]).dropna()\n",
    "\n",
    "exposure_to_violent_crime = CSVs[6].drop(columns=[\"Characteristic\", \"Note on Percent\", \"Note on Count\"]).dropna()\n",
    "\n",
    "reading_scores = CSVs[7].drop(columns=\"Characteristic\").dropna()\n",
    "\n",
    "young_adult_living_arrangements = CSVs[8].drop(columns=\"Characteristic\").dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Add column to be consistent with 'young_woman_births' df\n",
    "adolesent_births[\"Age\"] = \"Ages 15-17\"\n",
    "#adolesent_births"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {},
   "outputs": [],
   "source": [
    "#young_woman_births\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.set_option('display.max_rows', 100)\n",
    "#child_housing_problems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {},
   "outputs": [],
   "source": [
    "test = \"Total - Hispanic, With severe housing problems\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['Total - Hispanic', ' With severe housing problems']"
      ]
     },
     "execution_count": 132,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test.split(sep = \",\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {},
   "outputs": [],
   "source": [
    "child_housing_problems[\"Characteristic\"] = child_housing_problems[\"Characteristic\"].str.replace(\"Total - \", \"\")\n",
    "#child_housing_problems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Split the character column by racial category and housing variable\n",
    "child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)\n",
    "\n",
    "# Set the housing variable as a column in the df\n",
    "child_housing_problems[\"housing_situation\"] = child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)[1]\n",
    "\n",
    "# Set the characteristic column to be consistent with the other dataframes\n",
    "child_housing_problems[\"characteristic\"] = child_housing_problems[\"Characteristic\"].str.rsplit(\", \", expand=True, n=1)[0]\n",
    "\n",
    "# Drop the old Characteristic column\n",
    "child_housing_problems = child_housing_problems.drop(columns = [\"Characteristic\"])\n",
    "\n",
    "# child_housing_problems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {},
   "outputs": [],
   "source": [
    "# TODO\n",
    "# How to aggregate this data so it's useful \n",
    "# child_maltreatment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.set_option('display.max_rows', 100)\n",
    "child_poverty_percent['percent_living_in_poverty'] = child_poverty_percent['Percentage']\n",
    "child_poverty_percent = child_poverty_percent.drop(columns = \"Percentage\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Change column name\n",
    "exposure_to_violent_crime['percent_exposed_to_violent_crime'] = exposure_to_violent_crime['Percentage']\n",
    "exposure_to_violent_crime = exposure_to_violent_crime.drop(columns = 'Percentage')\n",
    "\n",
    "# Change column name\n",
    "exposure_to_violent_crime['count_exposed_to_violent_crime'] = exposure_to_violent_crime['Count']\n",
    "exposure_to_violent_crime = exposure_to_violent_crime.drop(columns = 'Count')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {},
   "outputs": [],
   "source": [
    "reading_scores['4th_grade_reading_scale_scores'] = reading_scores['Score']\n",
    "reading_scores = reading_scores.drop(columns = 'Score')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 140,
   "metadata": {},
   "outputs": [],
   "source": [
    "# No changes\n",
    "# young_adult_living_arrangements\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
