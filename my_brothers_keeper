{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "files = [\"adolescent-births-2016\", \n",
    "\"birth-rates-for-young-adult-women-2016\",\n",
    "\"child-housing-problems-2016\",\n",
    "\"child-living-arrangements-2016\",\n",
    "\"child-maltreatment-2016\",\n",
    "\"child-poverty-percent-2016\",\n",
    "\"naep04-reading-2016\",\n",
    "\"young-adult-living-arrangements-2016\"]\n",
    "\n",
    "CSVs = []\n",
    "\n",
    "for file in files:\n",
    "    string_name = file + \".csv\"\n",
    "    csv = pd.read_csv(string_name, encoding = 'cp437')\n",
    "    csv = csv.replace('รป', '-', regex=True)  # Some CSVs have encoding issue where '-' is encoded as 'รป'\n",
    "    csv[\"Notes\"] = 0   # Add notes column if it does not exist\n",
    "    csv = csv.drop(columns = [\"Characteristic\", \"Notes\"])  # Drop Characteristic and Notes columns\n",
    "    csv = csv.dropna()   # Drop rows with NAs\n",
    "    CSVs.append(csv)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Percentage</th>\n",
       "      <th>Standard Error on Percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>90.000000</td>\n",
       "      <td>90.000000</td>\n",
       "      <td>90.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>2007.000000</td>\n",
       "      <td>22.292222</td>\n",
       "      <td>0.184667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>4.344698</td>\n",
       "      <td>13.241467</td>\n",
       "      <td>0.148537</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>2000.000000</td>\n",
       "      <td>3.300000</td>\n",
       "      <td>0.040000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>2003.000000</td>\n",
       "      <td>11.600000</td>\n",
       "      <td>0.060000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>2007.000000</td>\n",
       "      <td>21.100000</td>\n",
       "      <td>0.160000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>2011.000000</td>\n",
       "      <td>29.850000</td>\n",
       "      <td>0.210000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>2014.000000</td>\n",
       "      <td>55.500000</td>\n",
       "      <td>0.630000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Year  Percentage  Standard Error on Percentage\n",
       "count    90.000000   90.000000                     90.000000\n",
       "mean   2007.000000   22.292222                      0.184667\n",
       "std       4.344698   13.241467                      0.148537\n",
       "min    2000.000000    3.300000                      0.040000\n",
       "25%    2003.000000   11.600000                      0.060000\n",
       "50%    2007.000000   21.100000                      0.160000\n",
       "75%    2011.000000   29.850000                      0.210000\n",
       "max    2014.000000   55.500000                      0.630000"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CSVs[0].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [],
   "source": [
    "CSVs[0].rename(columns = {\"Percentage\":\"pct_15-17_gave_birth\",\n",
    "                                \"Standard Error on Percentage\": \"SE\"}\n",
    "              ).drop(columns = [\"Characteristic\", \"Notes\"]).dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Race/ethnicity</th>\n",
       "      <th>Year</th>\n",
       "      <th>per_1000_f</th>\n",
       "      <th>SE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2000</td>\n",
       "      <td>15.8</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2001</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2002</td>\n",
       "      <td>13.1</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2003</td>\n",
       "      <td>12.4</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>White, non-Hispanic</td>\n",
       "      <td>2004</td>\n",
       "      <td>12.0</td>\n",
       "      <td>0.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2010</td>\n",
       "      <td>5.1</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>86</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2011</td>\n",
       "      <td>4.6</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>87</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2012</td>\n",
       "      <td>4.1</td>\n",
       "      <td>0.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2013</td>\n",
       "      <td>3.7</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89</th>\n",
       "      <td>Asian/Pacific Islander</td>\n",
       "      <td>2014</td>\n",
       "      <td>3.3</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>75 rows ร 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Race/ethnicity  Year  per_1000_f    SE\n",
       "15     White, non-Hispanic  2000        15.8  0.06\n",
       "16     White, non-Hispanic  2001        14.0  0.06\n",
       "17     White, non-Hispanic  2002        13.1  0.06\n",
       "18     White, non-Hispanic  2003        12.4  0.06\n",
       "19     White, non-Hispanic  2004        12.0  0.06\n",
       "..                     ...   ...         ...   ...\n",
       "85  Asian/Pacific Islander  2010         5.1  0.13\n",
       "86  Asian/Pacific Islander  2011         4.6  0.12\n",
       "87  Asian/Pacific Islander  2012         4.1  0.11\n",
       "88  Asian/Pacific Islander  2013         3.7  0.10\n",
       "89  Asian/Pacific Islander  2014         3.3  0.10\n",
       "\n",
       "[75 rows x 4 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CSVs[0].rename(columns = {\"Percentage\":\"per_1000_f\",\n",
    "                                \"Standard Error on Percentage\": \"SE\"}).drop(columns = [\"Characteristic\", \"Notes\"]).dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Characteristic</th>\n",
       "      <th>Sex</th>\n",
       "      <th>Age</th>\n",
       "      <th>Race/ethnicity</th>\n",
       "      <th>Year</th>\n",
       "      <th>Percentage</th>\n",
       "      <th>Standard Error on Percentage</th>\n",
       "      <th>Note on Percent</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Total - Ages 0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2002</td>\n",
       "      <td>16.7</td>\n",
       "      <td>0.3</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Total - Ages 0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2003</td>\n",
       "      <td>17.6</td>\n",
       "      <td>0.3</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Total - Ages 0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2004</td>\n",
       "      <td>17.8</td>\n",
       "      <td>0.3</td>\n",
       "      <td>For 2004, figures are revised to reflect a cor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Total - Ages 0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2005</td>\n",
       "      <td>17.6</td>\n",
       "      <td>0.3</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Total - Ages 0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2006</td>\n",
       "      <td>17.4</td>\n",
       "      <td>0.3</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>751</th>\n",
       "      <td>Total - Female, Ages 6-17, Hispanic</td>\n",
       "      <td>Female</td>\n",
       "      <td>6-17</td>\n",
       "      <td>Hispanic</td>\n",
       "      <td>2011</td>\n",
       "      <td>34.4</td>\n",
       "      <td>1.5</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>752</th>\n",
       "      <td>Total - Female, Ages 6-17, Hispanic</td>\n",
       "      <td>Female</td>\n",
       "      <td>6-17</td>\n",
       "      <td>Hispanic</td>\n",
       "      <td>2012</td>\n",
       "      <td>33.0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>753</th>\n",
       "      <td>Total - Female, Ages 6-17, Hispanic</td>\n",
       "      <td>Female</td>\n",
       "      <td>6-17</td>\n",
       "      <td>Hispanic</td>\n",
       "      <td>2013</td>\n",
       "      <td>28.8</td>\n",
       "      <td>1.5</td>\n",
       "      <td>Data are based on the Current Population Surve...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>754</th>\n",
       "      <td>Total - Female, Ages 6-17, Hispanic</td>\n",
       "      <td>Female</td>\n",
       "      <td>6-17</td>\n",
       "      <td>Hispanic</td>\n",
       "      <td>2013</td>\n",
       "      <td>32.6</td>\n",
       "      <td>1.6</td>\n",
       "      <td>The source of these 2013 estimates is the port...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>755</th>\n",
       "      <td>Total - Female, Ages 6-17, Hispanic</td>\n",
       "      <td>Female</td>\n",
       "      <td>6-17</td>\n",
       "      <td>Hispanic</td>\n",
       "      <td>2014</td>\n",
       "      <td>29.9</td>\n",
       "      <td>1.5</td>\n",
       "      <td>The standard errors for this data are calculat...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>756 rows ร 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                          Characteristic     Sex    Age Race/ethnicity  Year  \\\n",
       "0                      Total - Ages 0-17     NaN   0-17            NaN  2002   \n",
       "1                      Total - Ages 0-17     NaN   0-17            NaN  2003   \n",
       "2                      Total - Ages 0-17     NaN   0-17            NaN  2004   \n",
       "3                      Total - Ages 0-17     NaN   0-17            NaN  2005   \n",
       "4                      Total - Ages 0-17     NaN   0-17            NaN  2006   \n",
       "..                                   ...     ...    ...            ...   ...   \n",
       "751  Total - Female, Ages 6-17, Hispanic  Female   6-17       Hispanic  2011   \n",
       "752  Total - Female, Ages 6-17, Hispanic  Female   6-17       Hispanic  2012   \n",
       "753  Total - Female, Ages 6-17, Hispanic  Female   6-17       Hispanic  2013   \n",
       "754  Total - Female, Ages 6-17, Hispanic  Female   6-17       Hispanic  2013   \n",
       "755  Total - Female, Ages 6-17, Hispanic  Female   6-17       Hispanic  2014   \n",
       "\n",
       "     Percentage  Standard Error on Percentage  \\\n",
       "0          16.7                           0.3   \n",
       "1          17.6                           0.3   \n",
       "2          17.8                           0.3   \n",
       "3          17.6                           0.3   \n",
       "4          17.4                           0.3   \n",
       "..          ...                           ...   \n",
       "751        34.4                           1.5   \n",
       "752        33.0                           1.4   \n",
       "753        28.8                           1.5   \n",
       "754        32.6                           1.6   \n",
       "755        29.9                           1.5   \n",
       "\n",
       "                                       Note on Percent  \n",
       "0    The standard errors for this data are calculat...  \n",
       "1    The standard errors for this data are calculat...  \n",
       "2    For 2004, figures are revised to reflect a cor...  \n",
       "3    The standard errors for this data are calculat...  \n",
       "4    The standard errors for this data are calculat...  \n",
       "..                                                 ...  \n",
       "751  The standard errors for this data are calculat...  \n",
       "752  The standard errors for this data are calculat...  \n",
       "753  Data are based on the Current Population Surve...  \n",
       "754  The source of these 2013 estimates is the port...  \n",
       "755  The standard errors for this data are calculat...  \n",
       "\n",
       "[756 rows x 8 columns]"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CSVs[5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
